{"version":3,"file":"index.js","sources":["../src/lib/OpenCvProvider.tsx","../node_modules/mirada/dist/src/types/opencv/Affine3.js","../node_modules/mirada/dist/src/types/opencv/Algorithm.js","../node_modules/mirada/dist/src/types/opencv/AutoBuffer.js","../node_modules/mirada/dist/src/types/opencv/BFMatcher.js","../node_modules/mirada/dist/src/types/opencv/BOWTrainer.js","../node_modules/mirada/dist/src/types/opencv/calib3d.js","../node_modules/mirada/dist/src/types/opencv/CascadeClassifier.js","../node_modules/mirada/dist/src/types/opencv/core_array.js","../node_modules/mirada/dist/src/types/opencv/core_cluster.js","../node_modules/mirada/dist/src/types/opencv/core_hal_interface.js","../node_modules/mirada/dist/src/types/opencv/core_utils.js","../node_modules/mirada/dist/src/types/opencv/DescriptorMatcher.js","../node_modules/mirada/dist/src/types/opencv/dnn.js","../node_modules/mirada/dist/src/types/opencv/DynamicBitset.js","../node_modules/mirada/dist/src/types/opencv/Exception.js","../node_modules/mirada/dist/src/types/opencv/features2d_draw.js","../node_modules/mirada/dist/src/types/opencv/FlannBasedMatcher.js","../node_modules/mirada/dist/src/types/opencv/HOGDescriptor.js","../node_modules/mirada/dist/src/types/opencv/imgproc_color_conversions.js","../node_modules/mirada/dist/src/types/opencv/imgproc_draw.js","../node_modules/mirada/dist/src/types/opencv/imgproc_feature.js","../node_modules/mirada/dist/src/types/opencv/imgproc_filter.js","../node_modules/mirada/dist/src/types/opencv/imgproc_hist.js","../node_modules/mirada/dist/src/types/opencv/imgproc_misc.js","../node_modules/mirada/dist/src/types/opencv/imgproc_object.js","../node_modules/mirada/dist/src/types/opencv/imgproc_shape.js","../node_modules/mirada/dist/src/types/opencv/imgproc_transform.js","../node_modules/mirada/dist/src/types/opencv/Logger.js","../node_modules/mirada/dist/src/types/opencv/LshTable.js","../node_modules/mirada/dist/src/types/opencv/MatExpr.js","../node_modules/mirada/dist/src/types/opencv/MatOp.js","../node_modules/mirada/dist/src/types/opencv/Matx.js","../node_modules/mirada/dist/src/types/opencv/Node.js","../node_modules/mirada/dist/src/types/opencv/objdetect.js","../node_modules/mirada/dist/src/types/opencv/PCA.js","../node_modules/mirada/dist/src/types/opencv/photo_inpaint.js","../node_modules/mirada/dist/src/types/opencv/RotatedRect.js","../node_modules/mirada/dist/src/types/opencv/softdouble.js","../node_modules/mirada/dist/src/types/opencv/softfloat.js","../node_modules/mirada/dist/src/types/opencv/video_track.js","../node_modules/mirada/dist/src/types/opencv/_types.js","../node_modules/mirada/dist/src/types/opencv/Mat.js","../node_modules/mirada/dist/src/types/_cv.js","../node_modules/mirada/dist/src/types/opencv/_hacks.js","../node_modules/mirada/dist/src/types/opencv/index.js","../src/lib/useOpenCv.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/ban-ts-comment */\nimport type { CV } from 'mirada';\nimport React from 'react';\n\nconst OpenCvContext = React.createContext<{ loaded: boolean; cv?: CV }>({ loaded: false, cv: undefined });\n\nconst { Consumer: OpenCvConsumer, Provider } = OpenCvContext;\n\nexport { OpenCvConsumer, OpenCvContext };\n\nconst scriptId = 'opencv-react';\nconst moduleConfig = {\n  wasmBinaryFile: 'opencv_js.wasm',\n  usingWasm: true,\n  onRuntimeInitialized: () => {},\n};\n\nexport interface IOpenCvProviderProps {\n  openCvVersion?: string;\n  openCvPath?: string;\n  children: React.ReactNode;\n}\n\nexport const OpenCvProvider: React.FC<IOpenCvProviderProps> = ({ openCvVersion = '5.x', openCvPath = '', children }) => {\n  const [cvInstance, setCvInstance] = React.useState<{ loaded: boolean; cv?: CV }>({\n    loaded: false,\n    cv: undefined,\n  });\n\n  React.useEffect(() => {\n    if (document.getElementById(scriptId) || window.cv) {\n      setCvInstance({ loaded: true, cv: window.cv });\n      return;\n    }\n\n    // https://docs.opencv.org/3.4/dc/de6/tutorial_js_nodejs.html\n    // https://medium.com/code-divoire/integrating-opencv-js-with-an-angular-application-20ae11c7e217\n    // https://stackoverflow.com/questions/56671436/cv-mat-is-not-a-constructor-opencv\n    moduleConfig.onRuntimeInitialized = () => {\n      setCvInstance({ loaded: true, cv: window.cv });\n    };\n    // @ts-ignore\n    window.Module = moduleConfig;\n\n    const generateOpenCvScriptTag = () => {\n      const js = document.createElement('script');\n      js.id = scriptId;\n      js.src = openCvPath || `https://docs.opencv.org/${openCvVersion}/opencv.js`;\n\n      js.nonce = 'true';\n      js.defer = true;\n      js.async = true;\n\n      return js;\n    };\n\n    document.body.appendChild(generateOpenCvScriptTag());\n  }, [openCvPath, openCvVersion]);\n\n  return <Provider value={cvInstance}>{children}</Provider>;\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=Affine3.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar _types_1 = require(\"./_types\");\n//# sourceMappingURL=Algorithm.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=AutoBuffer.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=BFMatcher.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=BOWTrainer.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=calib3d.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar _types_1 = require(\"./_types\");\n//# sourceMappingURL=CascadeClassifier.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=core_array.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=core_cluster.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=core_hal_interface.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=core_utils.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=DescriptorMatcher.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=dnn.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=DynamicBitset.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=Exception.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=features2d_draw.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=FlannBasedMatcher.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=HOGDescriptor.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=imgproc_color_conversions.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=imgproc_draw.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=imgproc_feature.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=imgproc_filter.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=imgproc_hist.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=imgproc_misc.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=imgproc_object.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=imgproc_shape.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=imgproc_transform.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=Logger.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=LshTable.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar _types_1 = require(\"./_types\");\n//# sourceMappingURL=MatExpr.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=MatOp.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=Matx.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=Node.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=objdetect.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=PCA.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=photo_inpaint.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=RotatedRect.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=softdouble.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=softfloat.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=video_track.js.map","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./Affine3\"));\n__export(require(\"./Algorithm\"));\n__export(require(\"./AutoBuffer\"));\n__export(require(\"./BFMatcher\"));\n__export(require(\"./BOWTrainer\"));\n__export(require(\"./calib3d\"));\n__export(require(\"./CascadeClassifier\"));\n__export(require(\"./core_array\"));\n__export(require(\"./core_cluster\"));\n__export(require(\"./core_hal_interface\"));\n__export(require(\"./core_utils\"));\n__export(require(\"./DescriptorMatcher\"));\n__export(require(\"./dnn\"));\n__export(require(\"./DynamicBitset\"));\n__export(require(\"./Exception\"));\n__export(require(\"./features2d_draw\"));\n__export(require(\"./FlannBasedMatcher\"));\n__export(require(\"./HOGDescriptor\"));\n__export(require(\"./imgproc_color_conversions\"));\n__export(require(\"./imgproc_draw\"));\n__export(require(\"./imgproc_feature\"));\n__export(require(\"./imgproc_filter\"));\n__export(require(\"./imgproc_hist\"));\n__export(require(\"./imgproc_misc\"));\n__export(require(\"./imgproc_object\"));\n__export(require(\"./imgproc_shape\"));\n__export(require(\"./imgproc_transform\"));\n__export(require(\"./Logger\"));\n__export(require(\"./LshTable\"));\n__export(require(\"./Mat\"));\n__export(require(\"./MatExpr\"));\n__export(require(\"./MatOp\"));\n__export(require(\"./Matx\"));\n__export(require(\"./Node\"));\n__export(require(\"./objdetect\"));\n__export(require(\"./PCA\"));\n__export(require(\"./photo_inpaint\"));\n__export(require(\"./RotatedRect\"));\n__export(require(\"./softdouble\"));\n__export(require(\"./softfloat\"));\n__export(require(\"./video_track\"));\n__export(require(\"./_hacks\"));\n//# sourceMappingURL=_types.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar _types_1 = require(\"./_types\");\n//# sourceMappingURL=Mat.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=_cv.js.map","\"use strict\";\n// Scalar, Point, Rect, etc are defined by opencv.js (helpers.js) and we need to declare them manually:\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// Hack: expose Mat super classes like Mat_, InputArray, Vector, OutputArray we make them alias of Mat to simplify and make it work\nvar Mat_1 = require(\"./Mat\");\nexports.InputArray = Mat_1.Mat;\nexports.InputArrayOfArrays = Mat_1.Mat;\nexports.InputOutputArray = Mat_1.Mat;\nexports.InputOutputArrayOfArrays = Mat_1.Mat;\nexports.MatVector = Mat_1.Mat;\nexports.OutputArray = Mat_1.Mat;\nexports.OutputArrayOfArrays = Mat_1.Mat;\nvar _1 = require(\".\");\nrequire(\"../_cv\");\n//# sourceMappingURL=_hacks.js.map","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./_hacks\"));\n__export(require(\"./_types\"));\n//# sourceMappingURL=index.js.map","import { useContext } from 'react';\n\nimport { OpenCvContext } from './OpenCvProvider';\n\nexport const useOpenCv = () => useContext(OpenCvContext);\n"],"names":["OpenCvContext","React","createContext","loaded","cv","undefined","OpenCvConsumer","Consumer","Provider","moduleConfig","wasmBinaryFile","usingWasm","onRuntimeInitialized","Object","defineProperty","exports","value","__export","m","p","hasOwnProperty","require$$0","require$$1","require$$2","require$$3","require$$4","require$$5","require$$6","require$$7","require$$8","require$$9","require$$10","require$$11","require$$12","require$$13","require$$14","require$$15","require$$16","require$$17","require$$18","require$$19","require$$20","require$$21","require$$22","require$$23","require$$24","require$$25","require$$26","require$$27","require$$28","require$$29","require$$30","require$$31","require$$32","require$$33","require$$34","require$$35","require$$36","require$$37","require$$38","require$$39","require$$40","require$$41","Mat_1","Mat","_ref","openCvVersion","_ref$openCvVersion","_ref$openCvPath","openCvPath","children","_React$useState","useState","cvInstance","setCvInstance","useEffect","js","document","getElementById","window","Module","body","appendChild","createElement","id","src","nonce","defer","async","useContext"],"mappings":"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"}